üöÄ Starting FHIR Bulk Export Encryption/Decryption Demo üöÄ
Sodium (libsodium-wrappers) initialized.
üîë Client: Generating P-384 ECDH-ES key pair for key agreement...
üîë Client (EC): Generated Public JWK: {"crv":"P-384","kty":"EC","x":"noH9EuVQf28XoKeHqzYfZjJ3YZE905yTHWWUehr43REct5kTVvDhrowXZ22gpgWl","y":"HSS8z9r-vni4YvOU7UazILzWvboVifms3mFFpgfNpfTgJ2YetRnyccow1XcisNN9","kid":"client-p384-key-we3kjl4t","alg":"ECDH-ES+A256KW","use":"enc","exp":1746674401}
üîë Client (EC): Generated Private JWK (DEMO ONLY): {"crv":"P-384","d":"hZEJcnBehkt859LHcHbeJSxIHT9vIqbIy_hr9JuE7Uj7J6KNmzl8YQCkAuZ-R0x4","kty":"EC","x":"noH9EuVQf28XoKeHqzYfZjJ3YZE905yTHWWUehr43REct5kTVvDhrowXZ22gpgWl","y":"HSS8z9r-vni4YvOU7UazILzWvboVifms3mFFpgfNpfTgJ2YetRnyccow1XcisNN9","kid":"client-p384-key-we3kjl4t","alg":"ECDH-ES+A256KW"}
üîë Client: Generating RSA-OAEP-256 3072-bit key pair...
üîë Client (RSA): Generated Public JWK: {"e":"AQAB","kty":"RSA","n":"xlrMwKuKA03-qTYU3ONBrmsDLnghqZ0UYcbw62EN3aZESMQl_G1_pzhW8HafPoAmN-USQJhmqc71XifOBTQPdQXTz1BSLuYaKvM0H0ZVbkQQcx9VKSoQrDgMcUYupGlTmaKpJz9vuILLaZl80c68wzamTrY9K-8ger3uwppSzvYvO24xujvy_yqGWBVzG1AhvPNvvagteidgx8Y7dudJL95vZZiVltF05zZNdnzwFRNN1enrZjdtyizywh9YBzyARdONXJ2QK7sQtAq06qrsDG6gjTDBeuW555QDDqeqfgLSZsAPVWjce-FowUY2VqZc1oe5et_vL1TxvvPt_CThakq9Z7Vos9bwiRqS3rvyJvFCXAftUg8LLj2JJICjvFM6LpvsvA7cwOTuO1KjModjUDCMoW_uPEnRUgS6pJ0EXYHz4_O2JYh6-7EqFrWFMwQ-BN-hjXvgfGbN8nBLt-NlI4QMiWBAhhgR1v0xuZR0LFHY-phtL29xK4Ft4_DRbLMj","kid":"client-rsa3072-key-rlr1btll","alg":"RSA-OAEP-256","use":"enc","exp":1746674402}
üîë Client (RSA): Generated Private JWK (DEMO ONLY): {"d":"FCcUh3zGNGi_t2xtuTWDrldkBtwgu21grUB7qMZ_FKZ4aJY5L8jmP9SbDKpYqo51k5c8AAEb6SPETTEpHuE3stGJQBZuiyJIxVVZVdYdBut2amPkEJ8b-4tkRDv3sC-dVU4v9nNdA_eR-CQmiOCC0Cikw_mDBIwylhXnBLGOOUXM7bJX7g56NU-aP6fKPpupGdv33eKQ4EjQ7esnjoCYMHtegQl8JUsZoAYl36R49gM0lMfD6Wo3RuPDNFLf7DhKuDbStIpFDPIxJB7T49K8gbEHbPFstA1DSdzHW2arb57rss_ZhBRJxsTymjtzC-C9xnOS0tpZ4_SR3qKOiOWkGMUrkph7VK_M1j-Owg3qC6C6SyOhStO6agrbeT1Lju2uzm6g2piKPx12WoQwGsu3Sdwyja0B-Ce2iDv3RmCYfiM2ZOupSncs-cwoud8fzwnO701gfhIXZOZ-ULHiNq1cxZD2TZyzjeYCQH_GCS_Y1U1uyQs3E-ziU_R6txfa-Zod","dp":"bNC0uoLmsj7wp-vyolCcUAdLYAvorVIsrwZgLDaiZjzv5giO4LLXDSJFnON3lVZfcQ3xBn_3eEaYkqwHpZ_141MNRKwezQENQzKT2V7dmQL9NSnTJ8IZummpOUHfm2bPD0aB1LhA8VmL3vYkwuZKshlkgJ3qUk2C766ePMoxotnxwPPvo61TyvtL_iL5DCPdddXi5Bw4pTIC7y8YHvyJ_mru-ZgGQM5kYMcnGkvTUYHn1FwjEPVb7-DihDPiSWEv","dq":"zJgV9_Chxo9IQNIo4fu_SIb00eIF_2KMOKfZv121GBwISL6qVixmKRvy4qdqI7zk2JiUp7NLB_7_SNVAWyLmGebO63w7rkhTyfrH_Xc1pGrsO2VGlnNYtz9H3guLd3A1Ya7wqnSZ66ZvIPhYRi8GW1pUqC_5HK_yQjxwJiW6COGRcLqgOjsZS4DSdrckW1y7VMq3cBZK0dZcVbCOndkv2Jr2VwFfV5nrYaJcT4FA-ptkzPIVCf9KxDppuGNTpoa9","e":"AQAB","kty":"RSA","n":"xlrMwKuKA03-qTYU3ONBrmsDLnghqZ0UYcbw62EN3aZESMQl_G1_pzhW8HafPoAmN-USQJhmqc71XifOBTQPdQXTz1BSLuYaKvM0H0ZVbkQQcx9VKSoQrDgMcUYupGlTmaKpJz9vuILLaZl80c68wzamTrY9K-8ger3uwppSzvYvO24xujvy_yqGWBVzG1AhvPNvvagteidgx8Y7dudJL95vZZiVltF05zZNdnzwFRNN1enrZjdtyizywh9YBzyARdONXJ2QK7sQtAq06qrsDG6gjTDBeuW555QDDqeqfgLSZsAPVWjce-FowUY2VqZc1oe5et_vL1TxvvPt_CThakq9Z7Vos9bwiRqS3rvyJvFCXAftUg8LLj2JJICjvFM6LpvsvA7cwOTuO1KjModjUDCMoW_uPEnRUgS6pJ0EXYHz4_O2JYh6-7EqFrWFMwQ-BN-hjXvgfGbN8nBLt-NlI4QMiWBAhhgR1v0xuZR0LFHY-phtL29xK4Ft4_DRbLMj","p":"6_nP9pPCnMbjXfkgVfTkNlieKeQjAyZhv201e2LNOWKLIoGHO2vTCTxt8hDlIOjA_zCmNBIcT9j5H7Y4jIveLZCLZTJwn0CTf3pJaJ0TgexzcXFnLk3k8rzhuWVG_R1sZzkcpo5gZVVa3znhKF92xjQeRnKi9zKBdn7-2fXwrS0YjEJQwjIgYOZVNnfBTr66ZE6meH_8N47UV6yj4RqH4b_rtUclY6YmgHdWY-5TjTZaM2Jm5a82O6AYcHr8MLhn","q":"1y-62NyMGAv94Wbzp59GxuXjZo3H_dU_AfOo8o8hk9A6lt1_bzbFUT6Zm7TV5cJ3Z7b9f8af8CIlcYfAVmONXKDOnSTLtLvUR4euOhkZS0XTSQRZyucHmVJ_ZCgnWsIC6IenQ4bzcQt0EIvr7axtvNBMEMPUSgFZ-JuSN5QIB8WBbcxDLzk7hW4E8-6Tk5_O5wI3I2rotbqJFPXyrIdBm0f80egKhYVPYISk8-HpcbXbYP_ZEaOJ-KJjrHSUrunl","qi":"YqpXuRilVCrxoFZohlkzxHqPHJwwZIOh9lz51W9P8-EZavYkox2FkIrGFkzbZkDj74PJRDth1U_uF476N6do8doZqFiR3lQaAVUzs2EDn-G51wrzBULM-lIBEoGcgpnVeN-2gykGF0l44-XTv6ojN44NLCARKwrcyea10tiNyufTNBE1NON8oRt1f3GwO_RJQFP436OBvHbWBzTPw_BQ8vOQQetxWvgAsyFjxpeMFkvli2PxZ04z6X6E0JLviipe","kid":"client-rsa3072-key-rlr1btll"}

üß™üß™üß™ Starting Test Runs for File Size: 100MB üß™üß™üß™

--- Starting ECDH-ES Demo - 100MB Streaming File Flow (EC Keys) ---
[RUN] Pre-emptively deleting ./tmp_enc_ecdh-es_demo_100MB.bin and ./tmp_dec_ecdh-es_demo_100MB.bin if they exist...
[RUN] Pre-emptive deletion complete.
üõ°Ô∏è Server: Generating Content Encryption Key (CEK) for NDJSON...
üõ°Ô∏è Server: Generated CEK (base64url): 3JG29wFeM0DxWCI-NPkECd636cSnDIdoigZFVwOJzZI (DEMO ONLY - DO NOT LOG IN PROD)
[RUN] Non-GZIP mode: JWE chunk parameter set to fixed size: 1048576 B
üîê Encrypting ./source_data_ecdh-es_demo_100MB.ndjson ‚Üí ./tmp_enc_ecdh-es_demo_100MB.bin
üîê Encryption complete: ./tmp_enc_ecdh-es_demo_100MB.bin
üõ°Ô∏è Server: Wrapping CEK with client's public key using JWE (alg: ECDH-ES+A256KW)...
üõ°Ô∏è Server: JWE Payload to be encrypted: {
  "v": "0.5",
  "k": "3JG29wFeM0DxWCI-NPkECd636cSnDIdoigZFVwOJzZI",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson"
}
üõ°Ô∏è Server: CEK wrapped in JWE compact serialization.
üõ°Ô∏è Server: Compact JWE: eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJ2eDJRRUpNQWNqN0lhMnNHZUR5RXVVejUwQmg5TXN1S1ZkVE5pc1MtUmVqXzRiWXo1OTdkMTUxR2p3MFRiU0gwIiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiIwNXdGSEt4OXpoeHZyNmJLajQyV1pJWXp3YUl4QmVpWHpBQ2F5WG9wWFlnTmZUOV9DcUlmNWdQUkRDYWlITVBCIn19.IGJ_BXElmrsOZuTszWGMv-o8zzn_Bx3ec3S3YmIDpmfTABfKDIpAbA.mNzlL4xKeyX1Nne0.efCBwBWoPDEqScElZLSRCNp8Jk3baS2p8HxNytZKtMwLoKrg_iZL_z7JViY_1A12Fi-9rmHR9cnYcG64ffdPqkytcQX8rvj0ZNLONViX_CRVTmRPGdex5tdJs3zztb0vNW_2i2mNengYjRs8zvu5A7an0gPRSThf2uvuY9FWAq6LSzTWKzKY7qSgwBjlK7RVLuuFkQGE6DhrsamSngZU_g.rDLeVyESqlxjMAeKZ4V2gg
üõ°Ô∏è Server: Creating Bulk Export manifest ECDH-ES Demo - 100MB Stream...
üõ°Ô∏è Server: Manifest created: {
  "transactionTime": "2025-05-07T03:20:03.216Z",
  "request": "https://example.com/fhir/Patient/$export?_type=Patient,Observation&run=ECDH-ES Demo - 100MB Stream",
  "requiresAccessToken": true,
  "output": [
    {
      "type": "Patient",
      "url": "http://localhost:39355/download/encrypted_export_ecdh-es_demo_100MB.bin",
      "extension": {
        "http://argo.run/bulk-export-decryption-key": "eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJ2eDJRRUpNQWNqN0lhMnNHZUR5RXVVejUwQmg5TXN1S1ZkVE5pc1MtUmVqXzRiWXo1OTdkMTUxR2p3MFRiU0gwIiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiIwNXdGSEt4OXpoeHZyNmJLajQyV1pJWXp3YUl4QmVpWHpBQ2F5WG9wWFlnTmZUOV9DcUlmNWdQUkRDYWlITVBCIn19.IGJ_BXElmrsOZuTszWGMv-o8zzn_Bx3ec3S3YmIDpmfTABfKDIpAbA.mNzlL4xKeyX1Nne0.efCBwBWoPDEqScElZLSRCNp8Jk3baS2p8HxNytZKtMwLoKrg_iZL_z7JViY_1A12Fi-9rmHR9cnYcG64ffdPqkytcQX8rvj0ZNLONViX_CRVTmRPGdex5tdJs3zztb0vNW_2i2mNengYjRs8zvu5A7an0gPRSThf2uvuY9FWAq6LSzTWKzKY7qSgwBjlK7RVLuuFkQGE6DhrsamSngZU_g.rDLeVyESqlxjMAeKZ4V2gg"
      }
    }
  ]
}
üìÑ Client: Resolving manifest for file type "Patient"...
üìÑ Client: JWE string extracted from manifest: eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJ2eDJRRUpNQWNqN0lhMnNHZUR5RXVVejUwQmg5TXN1S1ZkVE5pc1MtUmVqXzRiWXo1OTdkMTUxR2p3MFRiU0gwIiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiIwNXdGSEt4OXpoeHZyNmJLajQyV1pJWXp3YUl4QmVpWHpBQ2F5WG9wWFlnTmZUOV9DcUlmNWdQUkRDYWlITVBCIn19.IGJ_BXElmrsOZuTszWGMv-o8zzn_Bx3ec3S3YmIDpmfTABfKDIpAbA.mNzlL4xKeyX1Nne0.efCBwBWoPDEqScElZLSRCNp8Jk3baS2p8HxNytZKtMwLoKrg_iZL_z7JViY_1A12Fi-9rmHR9cnYcG64ffdPqkytcQX8rvj0ZNLONViX_CRVTmRPGdex5tdJs3zztb0vNW_2i2mNengYjRs8zvu5A7an0gPRSThf2uvuY9FWAq6LSzTWKzKY7qSgwBjlK7RVLuuFkQGE6DhrsamSngZU_g.rDLeVyESqlxjMAeKZ4V2gg
üìÑ Client: Unwrapping CEK from JWE (expecting alg: ECDH-ES+A256KW)...
üìÑ Client: Received Compact JWE for unwrapping: eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJ2eDJRRUpNQWNqN0lhMnNHZUR5RXVVejUwQmg5TXN1S1ZkVE5pc1MtUmVqXzRiWXo1OTdkMTUxR2p3MFRiU0gwIiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiIwNXdGSEt4OXpoeHZyNmJLajQyV1pJWXp3YUl4QmVpWHpBQ2F5WG9wWFlnTmZUOV9DcUlmNWdQUkRDYWlITVBCIn19.IGJ_BXElmrsOZuTszWGMv-o8zzn_Bx3ec3S3YmIDpmfTABfKDIpAbA.mNzlL4xKeyX1Nne0.efCBwBWoPDEqScElZLSRCNp8Jk3baS2p8HxNytZKtMwLoKrg_iZL_z7JViY_1A12Fi-9rmHR9cnYcG64ffdPqkytcQX8rvj0ZNLONViX_CRVTmRPGdex5tdJs3zztb0vNW_2i2mNengYjRs8zvu5A7an0gPRSThf2uvuY9FWAq6LSzTWKzKY7qSgwBjlK7RVLuuFkQGE6DhrsamSngZU_g.rDLeVyESqlxjMAeKZ4V2gg
üìÑ Client: Decrypted JWE Payload: {
  "v": "0.5",
  "k": "3JG29wFeM0DxWCI-NPkECd636cSnDIdoigZFVwOJzZI",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson"
}
üìÑ Client: Unwrapped CEK (base64url): 3JG29wFeM0DxWCI-NPkECd636cSnDIdoigZFVwOJzZI (DEMO ONLY - DO NOT LOG IN PROD)
üìÑ Client: CEK successfully unwrapped (JWE alg: ECDH-ES+A256KW). ChunkSize: 1048576, ContentType: application/fhir+ndjson
üîì Decrypting to ./tmp_dec_ecdh-es_demo_100MB.bin (chunkSize: 1048576 B, encoding: none)
üîì Decryption complete: ./tmp_dec_ecdh-es_demo_100MB.bin
‚úÖ SUCCESS (ECDH-ES Demo - 100MB Stream): Decrypted file matches original (plain source). Encrypted size: 100 MB
--- ECDH-ES Demo - 100MB Streaming File Flow Complete (SUCCESS in Enc: 1100.12 ms, Dec: 1235.97 ms, Enc Size: 100 MB) ---


--- Starting RSA-OAEP Demo - 100MB Streaming File Flow (RSA Keys) ---
[RUN] Pre-emptively deleting ./tmp_enc_rsa-oaep_demo_100MB.bin and ./tmp_dec_rsa-oaep_demo_100MB.bin if they exist...
[RUN] Pre-emptive deletion complete.
üõ°Ô∏è Server: Generating Content Encryption Key (CEK) for NDJSON...
üõ°Ô∏è Server: Generated CEK (base64url): LO-9O7ML3h8nOW0c6dvmsGjL7MzCW7HACejimoD2oxo (DEMO ONLY - DO NOT LOG IN PROD)
[RUN] Non-GZIP mode: JWE chunk parameter set to fixed size: 1048576 B
üîê Encrypting ./source_data_rsa-oaep_demo_100MB.ndjson ‚Üí ./tmp_enc_rsa-oaep_demo_100MB.bin
üîê Encryption complete: ./tmp_enc_rsa-oaep_demo_100MB.bin
üõ°Ô∏è Server: Wrapping CEK with client's public key using JWE (alg: RSA-OAEP-256)...
üõ°Ô∏è Server: JWE Payload to be encrypted: {
  "v": "0.5",
  "k": "LO-9O7ML3h8nOW0c6dvmsGjL7MzCW7HACejimoD2oxo",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson"
}
üõ°Ô∏è Server: CEK wrapped in JWE compact serialization.
üõ°Ô∏è Server: Compact JWE: eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.CUsN-221eHdA1LXGxJIfaZwYm1mtsEtBUx7yV769UBC1DHvMHvbUSxJi3_h8Ng-HScrZPdoaJnXZPcpJEhMrB2F1_IwrluzMW-8-00NaypTuEYpO3c0SSWRYZYTzeM2FQZ6tQdtl9v0s1YBJWCwWJFxr3z2TIjuaov0mxZ0aDgmZaNGdIm5q8R2VP13QZDB183_zQsss8jqXQRm3WcqbLJks7Tkteqf3m5X-pAB7O9fHVeSa6AFAJdmA45PWJc4BvlMWm_F7RR_B88EKHUBYs4V_PI0N5V5Ghuf5L3BYcC0nQDg3V9_dpAnwS1hAhMVbU91h5bRRDZPq72Pmm4829HXu2iMfUbwAnzq6boBwdO6y33lBG8CoczEE1CC506vKMSPyeI7GBrjpz4MrVmSMo9Qkyu4CYKax-ierwo8i6cupg3hv5UDN0PBFT4yzCIq8X1U_nsFvplnY5hfeHxTvVEufDvemvdKOLj9SAlABmepyFKbUXEUMxlmH1g9xIWO4.XEkwHydc96sQKLjE.3AAoPt3nL4iMfBkqOh6iOjLBS4cW8yLAFcol8Q7ZP2jZhh2cjty4lI5mkChGKHtfmhKioFM_MjjE4rmM5Yp1TcTMAmonXqjZPke4GeeuiUs1V4Y_xhzzYZZB7X8YQ2-2cd4w13tj_dgwy-Sasn5L4ftnkhoclFA5YJP1_ESVelRCtbjXRHYkdHHw8nYlftlVoUWM2romYlCv1DOz5BD3hQ.JVuYP7sYJYC4v5bsnSL4FQ
üõ°Ô∏è Server: Creating Bulk Export manifest RSA-OAEP Demo - 100MB Stream...
üõ°Ô∏è Server: Manifest created: {
  "transactionTime": "2025-05-07T03:20:05.737Z",
  "request": "https://example.com/fhir/Patient/$export?_type=Patient,Observation&run=RSA-OAEP Demo - 100MB Stream",
  "requiresAccessToken": true,
  "output": [
    {
      "type": "Patient",
      "url": "http://localhost:37763/download/encrypted_export_rsa-oaep_demo_100MB.bin",
      "extension": {
        "http://argo.run/bulk-export-decryption-key": "eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.CUsN-221eHdA1LXGxJIfaZwYm1mtsEtBUx7yV769UBC1DHvMHvbUSxJi3_h8Ng-HScrZPdoaJnXZPcpJEhMrB2F1_IwrluzMW-8-00NaypTuEYpO3c0SSWRYZYTzeM2FQZ6tQdtl9v0s1YBJWCwWJFxr3z2TIjuaov0mxZ0aDgmZaNGdIm5q8R2VP13QZDB183_zQsss8jqXQRm3WcqbLJks7Tkteqf3m5X-pAB7O9fHVeSa6AFAJdmA45PWJc4BvlMWm_F7RR_B88EKHUBYs4V_PI0N5V5Ghuf5L3BYcC0nQDg3V9_dpAnwS1hAhMVbU91h5bRRDZPq72Pmm4829HXu2iMfUbwAnzq6boBwdO6y33lBG8CoczEE1CC506vKMSPyeI7GBrjpz4MrVmSMo9Qkyu4CYKax-ierwo8i6cupg3hv5UDN0PBFT4yzCIq8X1U_nsFvplnY5hfeHxTvVEufDvemvdKOLj9SAlABmepyFKbUXEUMxlmH1g9xIWO4.XEkwHydc96sQKLjE.3AAoPt3nL4iMfBkqOh6iOjLBS4cW8yLAFcol8Q7ZP2jZhh2cjty4lI5mkChGKHtfmhKioFM_MjjE4rmM5Yp1TcTMAmonXqjZPke4GeeuiUs1V4Y_xhzzYZZB7X8YQ2-2cd4w13tj_dgwy-Sasn5L4ftnkhoclFA5YJP1_ESVelRCtbjXRHYkdHHw8nYlftlVoUWM2romYlCv1DOz5BD3hQ.JVuYP7sYJYC4v5bsnSL4FQ"
      }
    }
  ]
}
üìÑ Client: Resolving manifest for file type "Patient"...
üìÑ Client: JWE string extracted from manifest: eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.CUsN-221eHdA1LXGxJIfaZwYm1mtsEtBUx7yV769UBC1DHvMHvbUSxJi3_h8Ng-HScrZPdoaJnXZPcpJEhMrB2F1_IwrluzMW-8-00NaypTuEYpO3c0SSWRYZYTzeM2FQZ6tQdtl9v0s1YBJWCwWJFxr3z2TIjuaov0mxZ0aDgmZaNGdIm5q8R2VP13QZDB183_zQsss8jqXQRm3WcqbLJks7Tkteqf3m5X-pAB7O9fHVeSa6AFAJdmA45PWJc4BvlMWm_F7RR_B88EKHUBYs4V_PI0N5V5Ghuf5L3BYcC0nQDg3V9_dpAnwS1hAhMVbU91h5bRRDZPq72Pmm4829HXu2iMfUbwAnzq6boBwdO6y33lBG8CoczEE1CC506vKMSPyeI7GBrjpz4MrVmSMo9Qkyu4CYKax-ierwo8i6cupg3hv5UDN0PBFT4yzCIq8X1U_nsFvplnY5hfeHxTvVEufDvemvdKOLj9SAlABmepyFKbUXEUMxlmH1g9xIWO4.XEkwHydc96sQKLjE.3AAoPt3nL4iMfBkqOh6iOjLBS4cW8yLAFcol8Q7ZP2jZhh2cjty4lI5mkChGKHtfmhKioFM_MjjE4rmM5Yp1TcTMAmonXqjZPke4GeeuiUs1V4Y_xhzzYZZB7X8YQ2-2cd4w13tj_dgwy-Sasn5L4ftnkhoclFA5YJP1_ESVelRCtbjXRHYkdHHw8nYlftlVoUWM2romYlCv1DOz5BD3hQ.JVuYP7sYJYC4v5bsnSL4FQ
üìÑ Client: Unwrapping CEK from JWE (expecting alg: RSA-OAEP-256)...
üìÑ Client: Received Compact JWE for unwrapping: eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.CUsN-221eHdA1LXGxJIfaZwYm1mtsEtBUx7yV769UBC1DHvMHvbUSxJi3_h8Ng-HScrZPdoaJnXZPcpJEhMrB2F1_IwrluzMW-8-00NaypTuEYpO3c0SSWRYZYTzeM2FQZ6tQdtl9v0s1YBJWCwWJFxr3z2TIjuaov0mxZ0aDgmZaNGdIm5q8R2VP13QZDB183_zQsss8jqXQRm3WcqbLJks7Tkteqf3m5X-pAB7O9fHVeSa6AFAJdmA45PWJc4BvlMWm_F7RR_B88EKHUBYs4V_PI0N5V5Ghuf5L3BYcC0nQDg3V9_dpAnwS1hAhMVbU91h5bRRDZPq72Pmm4829HXu2iMfUbwAnzq6boBwdO6y33lBG8CoczEE1CC506vKMSPyeI7GBrjpz4MrVmSMo9Qkyu4CYKax-ierwo8i6cupg3hv5UDN0PBFT4yzCIq8X1U_nsFvplnY5hfeHxTvVEufDvemvdKOLj9SAlABmepyFKbUXEUMxlmH1g9xIWO4.XEkwHydc96sQKLjE.3AAoPt3nL4iMfBkqOh6iOjLBS4cW8yLAFcol8Q7ZP2jZhh2cjty4lI5mkChGKHtfmhKioFM_MjjE4rmM5Yp1TcTMAmonXqjZPke4GeeuiUs1V4Y_xhzzYZZB7X8YQ2-2cd4w13tj_dgwy-Sasn5L4ftnkhoclFA5YJP1_ESVelRCtbjXRHYkdHHw8nYlftlVoUWM2romYlCv1DOz5BD3hQ.JVuYP7sYJYC4v5bsnSL4FQ
üìÑ Client: Decrypted JWE Payload: {
  "v": "0.5",
  "k": "LO-9O7ML3h8nOW0c6dvmsGjL7MzCW7HACejimoD2oxo",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson"
}
üìÑ Client: Unwrapped CEK (base64url): LO-9O7ML3h8nOW0c6dvmsGjL7MzCW7HACejimoD2oxo (DEMO ONLY - DO NOT LOG IN PROD)
üìÑ Client: CEK successfully unwrapped (JWE alg: RSA-OAEP-256). ChunkSize: 1048576, ContentType: application/fhir+ndjson
üîì Decrypting to ./tmp_dec_rsa-oaep_demo_100MB.bin (chunkSize: 1048576 B, encoding: none)
üîì Decryption complete: ./tmp_dec_rsa-oaep_demo_100MB.bin
‚úÖ SUCCESS (RSA-OAEP Demo - 100MB Stream): Decrypted file matches original (plain source). Encrypted size: 100 MB
--- RSA-OAEP Demo - 100MB Streaming File Flow Complete (SUCCESS in Enc: 1057.31 ms, Dec: 1076.14 ms, Enc Size: 100 MB) ---


--- 100MB / GZIP ---

--- Starting ECDH-ES Demo - 100MB_GZIP Streaming File Flow (EC Keys) ---
[RUN] Pre-emptively deleting ./tmp_enc_ecdh-es_demo_100MB_gzip.bin and ./tmp_dec_ecdh-es_demo_100MB_gzip.bin if they exist...
[RUN] Pre-emptive deletion complete.
üõ°Ô∏è Server: Generating Content Encryption Key (CEK) for NDJSON...
üõ°Ô∏è Server: Generated CEK (base64url): V5vD8HGasL7dMAubu5pPDjeP1-PfoFZmUsaWo3uICvI (DEMO ONLY - DO NOT LOG IN PROD)
[RUN] GZIP mode: JWE chunk parameter is FIXED at 1048576 B (actual gzipped size was 17757148 B)
üîê Encrypting ./source_data_ecdh-es_demo_100MB.ndjson.gz ‚Üí ./tmp_enc_ecdh-es_demo_100MB_gzip.bin
üîê Encryption complete: ./tmp_enc_ecdh-es_demo_100MB_gzip.bin
üõ°Ô∏è Server: Wrapping CEK with client's public key using JWE (alg: ECDH-ES+A256KW)...
üõ°Ô∏è Server: JWE Payload to be encrypted: {
  "v": "0.5",
  "k": "V5vD8HGasL7dMAubu5pPDjeP1-PfoFZmUsaWo3uICvI",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson",
  "content_encoding": "gzip"
}
üõ°Ô∏è Server: CEK wrapped in JWE compact serialization.
üõ°Ô∏è Server: Compact JWE: eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJZZEI2X1dsckYxRnhpeEREemxPMGNYTGRyc0Jyc2czUjhIM3F6SUN1LU5ya0R3enYxSnVodVMzN0dVcHVROHk4IiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiJfVU9kRXY3X0oxdEtuWG1BMVBaWWw5aFF4c3hQM0lCeTlfTndHWlliamNPUkttWV9PRXlXZ0lmbFRQOGtWMURnIn19.jBgPVAeT3GZkNBYCgODNpHkNjQ6afYMCbDvrkpSAwnCnZ1Nw62hqYw.7CTDYypF2cGlS1Af.YTFy1jTL-VhSsPqAMbEmhzfz3emgbAH7mZ_C1oZ0rlXaqgt8SSmDu7h5pTSRL9P7iY-4QG5389tb9kDYkmJtbJRZg2MGhrOFE0hzh2_71HRF1PAvRuDSMPX068l57-TTa94vbBDRSZCKYBwQy-vRm5L8Q8ujFwXxq-T2yJ3A5BoWogksVTKtRAIcMUOHqknHKfvb_03GFkjeLMVw8d57EuPSwHLLis2LuMLMQGAwBzPwG1ORPHD6z_p8.EhR9qxlXVQbx3GU0ZKMI9Q
üõ°Ô∏è Server: Creating Bulk Export manifest ECDH-ES Demo - 100MB_GZIP Stream...
üõ°Ô∏è Server: Manifest created: {
  "transactionTime": "2025-05-07T03:20:07.257Z",
  "request": "https://example.com/fhir/Patient/$export?_type=Patient,Observation&run=ECDH-ES Demo - 100MB_GZIP Stream",
  "requiresAccessToken": true,
  "output": [
    {
      "type": "Patient",
      "url": "http://localhost:35219/download/encrypted_export_ecdh-es_demo_100MB_gzip.bin",
      "extension": {
        "http://argo.run/bulk-export-decryption-key": "eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJZZEI2X1dsckYxRnhpeEREemxPMGNYTGRyc0Jyc2czUjhIM3F6SUN1LU5ya0R3enYxSnVodVMzN0dVcHVROHk4IiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiJfVU9kRXY3X0oxdEtuWG1BMVBaWWw5aFF4c3hQM0lCeTlfTndHWlliamNPUkttWV9PRXlXZ0lmbFRQOGtWMURnIn19.jBgPVAeT3GZkNBYCgODNpHkNjQ6afYMCbDvrkpSAwnCnZ1Nw62hqYw.7CTDYypF2cGlS1Af.YTFy1jTL-VhSsPqAMbEmhzfz3emgbAH7mZ_C1oZ0rlXaqgt8SSmDu7h5pTSRL9P7iY-4QG5389tb9kDYkmJtbJRZg2MGhrOFE0hzh2_71HRF1PAvRuDSMPX068l57-TTa94vbBDRSZCKYBwQy-vRm5L8Q8ujFwXxq-T2yJ3A5BoWogksVTKtRAIcMUOHqknHKfvb_03GFkjeLMVw8d57EuPSwHLLis2LuMLMQGAwBzPwG1ORPHD6z_p8.EhR9qxlXVQbx3GU0ZKMI9Q"
      }
    }
  ]
}
üìÑ Client: Resolving manifest for file type "Patient"...
üìÑ Client: JWE string extracted from manifest: eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJZZEI2X1dsckYxRnhpeEREemxPMGNYTGRyc0Jyc2czUjhIM3F6SUN1LU5ya0R3enYxSnVodVMzN0dVcHVROHk4IiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiJfVU9kRXY3X0oxdEtuWG1BMVBaWWw5aFF4c3hQM0lCeTlfTndHWlliamNPUkttWV9PRXlXZ0lmbFRQOGtWMURnIn19.jBgPVAeT3GZkNBYCgODNpHkNjQ6afYMCbDvrkpSAwnCnZ1Nw62hqYw.7CTDYypF2cGlS1Af.YTFy1jTL-VhSsPqAMbEmhzfz3emgbAH7mZ_C1oZ0rlXaqgt8SSmDu7h5pTSRL9P7iY-4QG5389tb9kDYkmJtbJRZg2MGhrOFE0hzh2_71HRF1PAvRuDSMPX068l57-TTa94vbBDRSZCKYBwQy-vRm5L8Q8ujFwXxq-T2yJ3A5BoWogksVTKtRAIcMUOHqknHKfvb_03GFkjeLMVw8d57EuPSwHLLis2LuMLMQGAwBzPwG1ORPHD6z_p8.EhR9qxlXVQbx3GU0ZKMI9Q
üìÑ Client: Unwrapping CEK from JWE (expecting alg: ECDH-ES+A256KW)...
üìÑ Client: Received Compact JWE for unwrapping: eyJhbGciOiJFQ0RILUVTK0EyNTZLVyIsImVuYyI6IkEyNTZHQ00iLCJraWQiOiJjbGllbnQtcDM4NC1rZXktd2Uza2psNHQiLCJjdHkiOiJhcHBsaWNhdGlvbi9qc29uIiwiZXBrIjp7IngiOiJZZEI2X1dsckYxRnhpeEREemxPMGNYTGRyc0Jyc2czUjhIM3F6SUN1LU5ya0R3enYxSnVodVMzN0dVcHVROHk4IiwiY3J2IjoiUC0zODQiLCJrdHkiOiJFQyIsInkiOiJfVU9kRXY3X0oxdEtuWG1BMVBaWWw5aFF4c3hQM0lCeTlfTndHWlliamNPUkttWV9PRXlXZ0lmbFRQOGtWMURnIn19.jBgPVAeT3GZkNBYCgODNpHkNjQ6afYMCbDvrkpSAwnCnZ1Nw62hqYw.7CTDYypF2cGlS1Af.YTFy1jTL-VhSsPqAMbEmhzfz3emgbAH7mZ_C1oZ0rlXaqgt8SSmDu7h5pTSRL9P7iY-4QG5389tb9kDYkmJtbJRZg2MGhrOFE0hzh2_71HRF1PAvRuDSMPX068l57-TTa94vbBDRSZCKYBwQy-vRm5L8Q8ujFwXxq-T2yJ3A5BoWogksVTKtRAIcMUOHqknHKfvb_03GFkjeLMVw8d57EuPSwHLLis2LuMLMQGAwBzPwG1ORPHD6z_p8.EhR9qxlXVQbx3GU0ZKMI9Q
üìÑ Client: Decrypted JWE Payload: {
  "v": "0.5",
  "k": "V5vD8HGasL7dMAubu5pPDjeP1-PfoFZmUsaWo3uICvI",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson",
  "content_encoding": "gzip"
}
üìÑ Client: Unwrapped CEK (base64url): V5vD8HGasL7dMAubu5pPDjeP1-PfoFZmUsaWo3uICvI (DEMO ONLY - DO NOT LOG IN PROD)
üìÑ Client: CEK successfully unwrapped (JWE alg: ECDH-ES+A256KW). ChunkSize: 1048576, ContentType: application/fhir+ndjson, ContentEncoding: gzip
üîì Decrypting to ./tmp_dec_ecdh-es_demo_100MB_gzip.bin (chunkSize: 1048576 B, encoding: gzip)
üîì Decryption complete: ./tmp_dec_ecdh-es_demo_100MB_gzip.bin
‚úÖ SUCCESS (ECDH-ES Demo - 100MB_GZIP Stream): Decrypted file matches original (gzipped source). Encrypted size: 16.93 MB
--- ECDH-ES Demo - 100MB_GZIP Streaming File Flow Complete (SUCCESS in Enc: 214.75 ms, Dec: 223.55 ms, Enc Size: 16.93 MB) ---


--- Starting RSA-OAEP Demo - 100MB_GZIP Streaming File Flow (RSA Keys) ---
[RUN] Pre-emptively deleting ./tmp_enc_rsa-oaep_demo_100MB_gzip.bin and ./tmp_dec_rsa-oaep_demo_100MB_gzip.bin if they exist...
[RUN] Pre-emptive deletion complete.
üõ°Ô∏è Server: Generating Content Encryption Key (CEK) for NDJSON...
üõ°Ô∏è Server: Generated CEK (base64url): bAJCeUo1oizbJ805Mr0r1CVkziZkr6-y84FUaU4pfQg (DEMO ONLY - DO NOT LOG IN PROD)
[RUN] GZIP mode: JWE chunk parameter is FIXED at 1048576 B (actual gzipped size was 17755449 B)
üîê Encrypting ./source_data_rsa-oaep_demo_100MB.ndjson.gz ‚Üí ./tmp_enc_rsa-oaep_demo_100MB_gzip.bin
üîê Encryption complete: ./tmp_enc_rsa-oaep_demo_100MB_gzip.bin
üõ°Ô∏è Server: Wrapping CEK with client's public key using JWE (alg: RSA-OAEP-256)...
üõ°Ô∏è Server: JWE Payload to be encrypted: {
  "v": "0.5",
  "k": "bAJCeUo1oizbJ805Mr0r1CVkziZkr6-y84FUaU4pfQg",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson",
  "content_encoding": "gzip"
}
üõ°Ô∏è Server: CEK wrapped in JWE compact serialization.
üõ°Ô∏è Server: Compact JWE: eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.tuAweIA2TlIhY17RTOlTErsZJwyG4ii-wH6SoC6qiGFMxKTvPLmTQA52w16TQxPU4TCMRJ-TLwvMWnFA5X6Oy3RZ9DV_bLbtd6qF5z84_7WyXAT_iBs73jF_t3eFozgRQxgHarFjKDVzSm9SxNIFHAnfe0rVbgdbDbI1JUiYV45Fm6samlXwNs9RhcMpK6YCesDAhbsl-fGvGOXP6L1h0WCBs5DbQO_0PByICvwrkfv2dbDqGRaj0iT5miArxZbCWemb6Tnujxpd6uV_NolfSn8In5o0Y09MIATcf0VK-wkSyirf3msTqn2nSUMPWpRJ6hRw5aE10Jk80glgY2qcDKHa9AZHk9NDjPdZ6w-bAaf0qAN-D9w6mFT4tj6PJ2pr3Q9fMweYiuJobNqbGVaCWGjMDkB1z58K28x0Jk7INQST9krhLPccUEDgmHuFmsLJCiYBMy2aw1qti6mo14UAxO3gFhm96WYqup4vl70po-aCW-OZKMaDnzDsesdZ68CS.EfPJ0mGgGCK5ad6L.__x0EjY0lz1BCzSGB0pnhzIIt2EJ4g8U90ba2VGQdKg0N35q-knrRB0pg-SsXibzH9eTcUsY1l504U_Q3-7DOXn0d-2iNPH8aJTLpqc9VZvZCP6liYa-zg2dAyDE4QbtdxdfjQx9bEVF-mCMPkteh3seXj9UO3EKkTFsT4mpuiWT9FL-rwBXSbVxYKrDQpTfZ-LcPgSW3EiL5Zoh7N-QMlpDY_zmHzUJeZpliUYg8vY0MsCH0AuDvc5t.gqrMNKPyenDIxVXAdTZJlg
üõ°Ô∏è Server: Creating Bulk Export manifest RSA-OAEP Demo - 100MB_GZIP Stream...
üõ°Ô∏è Server: Manifest created: {
  "transactionTime": "2025-05-07T03:20:07.723Z",
  "request": "https://example.com/fhir/Patient/$export?_type=Patient,Observation&run=RSA-OAEP Demo - 100MB_GZIP Stream",
  "requiresAccessToken": true,
  "output": [
    {
      "type": "Patient",
      "url": "http://localhost:43801/download/encrypted_export_rsa-oaep_demo_100MB_gzip.bin",
      "extension": {
        "http://argo.run/bulk-export-decryption-key": "eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.tuAweIA2TlIhY17RTOlTErsZJwyG4ii-wH6SoC6qiGFMxKTvPLmTQA52w16TQxPU4TCMRJ-TLwvMWnFA5X6Oy3RZ9DV_bLbtd6qF5z84_7WyXAT_iBs73jF_t3eFozgRQxgHarFjKDVzSm9SxNIFHAnfe0rVbgdbDbI1JUiYV45Fm6samlXwNs9RhcMpK6YCesDAhbsl-fGvGOXP6L1h0WCBs5DbQO_0PByICvwrkfv2dbDqGRaj0iT5miArxZbCWemb6Tnujxpd6uV_NolfSn8In5o0Y09MIATcf0VK-wkSyirf3msTqn2nSUMPWpRJ6hRw5aE10Jk80glgY2qcDKHa9AZHk9NDjPdZ6w-bAaf0qAN-D9w6mFT4tj6PJ2pr3Q9fMweYiuJobNqbGVaCWGjMDkB1z58K28x0Jk7INQST9krhLPccUEDgmHuFmsLJCiYBMy2aw1qti6mo14UAxO3gFhm96WYqup4vl70po-aCW-OZKMaDnzDsesdZ68CS.EfPJ0mGgGCK5ad6L.__x0EjY0lz1BCzSGB0pnhzIIt2EJ4g8U90ba2VGQdKg0N35q-knrRB0pg-SsXibzH9eTcUsY1l504U_Q3-7DOXn0d-2iNPH8aJTLpqc9VZvZCP6liYa-zg2dAyDE4QbtdxdfjQx9bEVF-mCMPkteh3seXj9UO3EKkTFsT4mpuiWT9FL-rwBXSbVxYKrDQpTfZ-LcPgSW3EiL5Zoh7N-QMlpDY_zmHzUJeZpliUYg8vY0MsCH0AuDvc5t.gqrMNKPyenDIxVXAdTZJlg"
      }
    }
  ]
}
üìÑ Client: Resolving manifest for file type "Patient"...
üìÑ Client: JWE string extracted from manifest: eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.tuAweIA2TlIhY17RTOlTErsZJwyG4ii-wH6SoC6qiGFMxKTvPLmTQA52w16TQxPU4TCMRJ-TLwvMWnFA5X6Oy3RZ9DV_bLbtd6qF5z84_7WyXAT_iBs73jF_t3eFozgRQxgHarFjKDVzSm9SxNIFHAnfe0rVbgdbDbI1JUiYV45Fm6samlXwNs9RhcMpK6YCesDAhbsl-fGvGOXP6L1h0WCBs5DbQO_0PByICvwrkfv2dbDqGRaj0iT5miArxZbCWemb6Tnujxpd6uV_NolfSn8In5o0Y09MIATcf0VK-wkSyirf3msTqn2nSUMPWpRJ6hRw5aE10Jk80glgY2qcDKHa9AZHk9NDjPdZ6w-bAaf0qAN-D9w6mFT4tj6PJ2pr3Q9fMweYiuJobNqbGVaCWGjMDkB1z58K28x0Jk7INQST9krhLPccUEDgmHuFmsLJCiYBMy2aw1qti6mo14UAxO3gFhm96WYqup4vl70po-aCW-OZKMaDnzDsesdZ68CS.EfPJ0mGgGCK5ad6L.__x0EjY0lz1BCzSGB0pnhzIIt2EJ4g8U90ba2VGQdKg0N35q-knrRB0pg-SsXibzH9eTcUsY1l504U_Q3-7DOXn0d-2iNPH8aJTLpqc9VZvZCP6liYa-zg2dAyDE4QbtdxdfjQx9bEVF-mCMPkteh3seXj9UO3EKkTFsT4mpuiWT9FL-rwBXSbVxYKrDQpTfZ-LcPgSW3EiL5Zoh7N-QMlpDY_zmHzUJeZpliUYg8vY0MsCH0AuDvc5t.gqrMNKPyenDIxVXAdTZJlg
üìÑ Client: Unwrapping CEK from JWE (expecting alg: RSA-OAEP-256)...
üìÑ Client: Received Compact JWE for unwrapping: eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMjU2R0NNIiwia2lkIjoiY2xpZW50LXJzYTMwNzIta2V5LXJscjFidGxsIiwiY3R5IjoiYXBwbGljYXRpb24vanNvbiJ9.tuAweIA2TlIhY17RTOlTErsZJwyG4ii-wH6SoC6qiGFMxKTvPLmTQA52w16TQxPU4TCMRJ-TLwvMWnFA5X6Oy3RZ9DV_bLbtd6qF5z84_7WyXAT_iBs73jF_t3eFozgRQxgHarFjKDVzSm9SxNIFHAnfe0rVbgdbDbI1JUiYV45Fm6samlXwNs9RhcMpK6YCesDAhbsl-fGvGOXP6L1h0WCBs5DbQO_0PByICvwrkfv2dbDqGRaj0iT5miArxZbCWemb6Tnujxpd6uV_NolfSn8In5o0Y09MIATcf0VK-wkSyirf3msTqn2nSUMPWpRJ6hRw5aE10Jk80glgY2qcDKHa9AZHk9NDjPdZ6w-bAaf0qAN-D9w6mFT4tj6PJ2pr3Q9fMweYiuJobNqbGVaCWGjMDkB1z58K28x0Jk7INQST9krhLPccUEDgmHuFmsLJCiYBMy2aw1qti6mo14UAxO3gFhm96WYqup4vl70po-aCW-OZKMaDnzDsesdZ68CS.EfPJ0mGgGCK5ad6L.__x0EjY0lz1BCzSGB0pnhzIIt2EJ4g8U90ba2VGQdKg0N35q-knrRB0pg-SsXibzH9eTcUsY1l504U_Q3-7DOXn0d-2iNPH8aJTLpqc9VZvZCP6liYa-zg2dAyDE4QbtdxdfjQx9bEVF-mCMPkteh3seXj9UO3EKkTFsT4mpuiWT9FL-rwBXSbVxYKrDQpTfZ-LcPgSW3EiL5Zoh7N-QMlpDY_zmHzUJeZpliUYg8vY0MsCH0AuDvc5t.gqrMNKPyenDIxVXAdTZJlg
üìÑ Client: Decrypted JWE Payload: {
  "v": "0.5",
  "k": "bAJCeUo1oizbJ805Mr0r1CVkziZkr6-y84FUaU4pfQg",
  "cipher": "secretstream_xchacha20poly1305",
  "chunk": 1048576,
  "content_type": "application/fhir+ndjson",
  "content_encoding": "gzip"
}
üìÑ Client: Unwrapped CEK (base64url): bAJCeUo1oizbJ805Mr0r1CVkziZkr6-y84FUaU4pfQg (DEMO ONLY - DO NOT LOG IN PROD)
üìÑ Client: CEK successfully unwrapped (JWE alg: RSA-OAEP-256). ChunkSize: 1048576, ContentType: application/fhir+ndjson, ContentEncoding: gzip
üîì Decrypting to ./tmp_dec_rsa-oaep_demo_100MB_gzip.bin (chunkSize: 1048576 B, encoding: gzip)
üîì Decryption complete: ./tmp_dec_rsa-oaep_demo_100MB_gzip.bin
‚úÖ SUCCESS (RSA-OAEP Demo - 100MB_GZIP Stream): Decrypted file matches original (gzipped source). Encrypted size: 16.93 MB
--- RSA-OAEP Demo - 100MB_GZIP Streaming File Flow Complete (SUCCESS in Enc: 190.67 ms, Dec: 178.13 ms, Enc Size: 16.93 MB) ---


üéâ All Demo Flows and Performance Tests Complete üéâ

üìä Timing Summary Table üìä
------------------------------------------------------------------------------------------------------------
| Test Case                               | Encrypted Size     | Enc Time (ms) | Dec Time (ms) | Status    |
|-----------------------------------------|--------------------|---------------|---------------|-----------|
| ECDH-ES Demo - 100MB                    |             100 MB |       1100.12 |       1235.97 | ‚úÖ SUCCESS |
| RSA-OAEP Demo - 100MB                   |             100 MB |       1057.31 |       1076.14 | ‚úÖ SUCCESS |
| ECDH-ES Demo - 100MB_GZIP               |           16.93 MB |        214.75 |        223.55 | ‚úÖ SUCCESS |
| RSA-OAEP Demo - 100MB_GZIP              |           16.93 MB |        190.67 |        178.13 | ‚úÖ SUCCESS |
------------------------------------------------------------------------------------------------------------
